% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/add_VHF.R
\name{add_VHF}
\alias{add_VHF}
\title{Calculate Vertical Horizontal Filter (Optimized)}
\usage{
add_VHF(
  OHLCV,
  n = 28,
  na.rm = TRUE,
  inf.replace = NA,
  zero.replace = NA,
  allow_middle_na = FALSE,
  append = FALSE
)
}
\arguments{
\item{OHLCV}{Object that is coercible to xts or matrix, assumed to contain Open - High - Low - Close - Volume data.}

\item{n}{Number of periods to use. Default is 28.}

\item{na.rm}{Logical. Should NA values be removed during calculations? Default is TRUE.}

\item{inf.replace}{Numeric value to replace INF/-INF values. Default is NA.}

\item{zero.replace}{Numeric value to replace division by zero results. Default is NA.}

\item{allow_middle_na}{Logical. If TRUE, allows NA values in the middle of the series.}

\item{append}{A logical value. If \code{TRUE}, the calculated VHF values will be appended to the \code{OHLCV} input data, ensuring
proper alignment of time - series data. If \code{FALSE}, only the calculated
VHF values will be returned. Defaults to \code{FALSE}.}
}
\value{
If \code{append = FALSE}, an object of the same class as \code{OHLCV}
or a vector (if \code{try.xts} fails) containing the VHF values with NA/INF values handled.
If \code{append = TRUE}, an object of the same class as \code{OHLCV} with the
calculated VHF values appended, maintaining the integrity of the time - series
alignment.
}
\description{
The Vertical Horizontal Filter (VHF) attempts to identify starting and ending
trends. This optimized version includes safeguards against NA and INF values.
}
\note{
If Close prices are given, the function calculates the max/min using
only those prices. If HLC prices are given, the function uses high/low prices.
}
\examples{
\dontrun{
# Example 1: Using closing prices
data("AAPL")
close_price <- Cl(AAPL)
vhf_close <- add_VHF(AAPL, n = 14)
chartSeries(AAPL, TA = "addTA(vhf_close,col='blue')")

# Example 2: Using HLC data
hlc_data <- HLC(AAPL)
vhf_hlc <- add_VHF(AAPL, n = 28, inf.replace = 0)

# Example 3: Handling NA values
test_data <- c(1:10, NA, 12:20)
vhf_na <- add_VHF(test_data, n = 5, na.rm = TRUE)

# Example 4: Zero - division protection
zero_test <- c(1, 1, 1, 1, 1)
vhf_zero <- add_VHF(zero_test, zero.replace = 0)
}
}
\references{
\url{https://www.metastock.com/Customer/Resources/TAAZ/?p=119}
}
\seealso{
See \code{\link{aroon}}, \code{\link{CCI}}, \code{\link{ADX}},
\code{\link{TDI}}, \code{\link{GMMA}} for other trend indicators.
}
\author{
Deng Yishuo
}
\keyword{ts}
